!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).PocketBase=e()}(this,function(){"use strict";var U=function(t,e){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}U(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var q=function(){return(q=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t,s,a,u){return new(a=a||Promise)(function(n,e){function o(t){try{r(u.next(t))}catch(t){e(t)}}function i(t){try{r(u.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(o,i)}r((u=u.apply(t,s||[])).next())})}function c(o,i){var r,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(n){return function(t){var e=[n,t];if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,s=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!((a=0<(a=u.trys).length&&a[a.length-1])||6!==e[0]&&2!==e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(o,u)}catch(t){e=[6,t],s=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}t(n,G=Error),n.prototype.toJSON=function(){return q({},this)};var G,h=n,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function n(t){var e=this;return(e=G.call(this,"ClientResponseError")||this).url="",e.status=0,e.data={},e.isAbort=!1,e.originalError=null,Object.setPrototypeOf(e,n.prototype),t instanceof n||(e.originalError=t),null!==t&&"object"==typeof t&&(e.url="string"==typeof t.url?t.url:"",e.status="number"==typeof t.status?t.status:0,e.data=null!==t.data&&"object"==typeof t.data?t.data:{}),"undefined"!=typeof DOMException&&t instanceof DOMException&&(e.isAbort=!0),e.name="ClientResponseError "+e.status,e.message=null==(t=e.data)?void 0:t.message,e.message||(e.message=e.isAbort?"The request was autocancelled. More info you could find in https://github.com/pocketbase/js-sdk#auto-cancellation.":"Something went wrong while processing your request."),e}function F(t,e,n){var n=Object.assign({},n||{}),o=n.encode||J;if(!r.test(t))throw new TypeError("argument name is invalid");o=o(e);if(o&&!r.test(o))throw new TypeError("argument val is invalid");var i=t+"="+o;if(null!=n.maxAge){e=+n.maxAge;if(isNaN(e)||!isFinite(e))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(e)}if(n.domain){if(!r.test(n.domain))throw new TypeError("option domain is invalid");i+="; Domain="+n.domain}if(n.path){if(!r.test(n.path))throw new TypeError("option path is invalid");i+="; Path="+n.path}if(n.expires){if(t=n.expires,!("[object Date]"===Object.prototype.toString.call(t)||t instanceof Date)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.priority)switch("string"==typeof n.priority?n.priority.toLowerCase():n.priority){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i}function D(t){return-1!==t.indexOf("%")?decodeURIComponent(t):t}function J(t){return encodeURIComponent(t)}function M(t){if(t)try{var e=decodeURIComponent(z(t.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch(t){}return{}}function e(t){this.client=t}function B(t,e,n,o,i){this.page=0<t?t:1,this.perPage=0<=e?e:0,this.totalItems=0<=n?n:0,this.totalPages=0<=o?o:0,this.items=i||[]}var o,i,s,a,u,d,p,f,v,y,K,m,b,g,z="function"==typeof atob?atob:function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,i=0,r=0,s="";o=e.charAt(r++);~o&&(n=i%4?64*n+o:o,i++%4)&&(s+=String.fromCharCode(255&n>>(-2*i&6))))o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s},w=(L.prototype.load=function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var o=n[e],i=o[0],o=o[1];this[i]=o}this.id=void 0!==t.id?t.id:"",this.created=void 0!==t.created?t.created:"",this.updated=void 0!==t.updated?t.updated:""},Object.defineProperty(L.prototype,"isNew",{get:function(){return!this.id},enumerable:!1,configurable:!0}),L.prototype.clone=function(){return new this.constructor(JSON.parse(JSON.stringify(this)))},L.prototype.export=function(){return Object.assign({},this)},L),S=(t(lt,g=w),lt.prototype.load=function(t){g.prototype.load.call(this,t),this.collectionId="string"==typeof t.collectionId?t.collectionId:"",this.collectionName="string"==typeof t.collectionName?t.collectionName:"",this.expand="object"==typeof t.expand&&null!==t.expand?t.expand:{}},lt),H=(t(ut,b=w),ut.prototype.load=function(t){b.prototype.load.call(this,t),this.avatar="number"==typeof t.avatar?t.avatar:0,this.email="string"==typeof t.email?t.email:""},ut),$="pb_auth",W=(Object.defineProperty(A.prototype,"token",{get:function(){return this.baseToken},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"model",{get:function(){return this.baseModel},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isValid",{get:function(){var t=this.token,e=void 0;return void 0===e&&(e=0),t=M(t),!!(0<Object.keys(t).length&&(!t.exp||t.exp-e>Date.now()/1e3))},enumerable:!1,configurable:!0}),A.prototype.save=function(t,e){this.baseToken=t||"",this.baseModel=null!==e&&"object"==typeof e?new(void 0!==e.collectionId?S:H)(e):null,this.triggerChange()},A.prototype.clear=function(){this.baseToken="",this.baseModel=null,this.triggerChange()},A.prototype.loadFromCookie=function(t,e){void 0===e&&(e=$);var e=function(t){var e={};if("string"!=typeof t)return e;for(var n=Object.assign({},{}).decode||D,o=0;o<t.length;){var i=t.indexOf("=",o);if(-1===i)break;var r=t.indexOf(";",o);if(-1===r)r=t.length;else if(r<i){o=t.lastIndexOf(";",i-1)+1;continue}var s=t.slice(o,i).trim();if(void 0===e[s]){i=t.slice(i+1,r).trim();34===i.charCodeAt(0)&&(i=i.slice(1,-1));try{e[s]=n(i)}catch(t){e[s]=i}}o=r+1}return e}(t||"")[e]||"",n={};try{null!==typeof(n=JSON.parse(e))&&"object"==typeof n&&!Array.isArray(n)||(n={})}catch(t){}this.save(n.token||"",n.model||null)},A.prototype.exportToCookie=function(t,e){void 0===e&&(e=$);var n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},o=M(this.token),n=(null!=o&&o.exp?n.expires=new Date(1e3*o.exp):n.expires=new Date("1970-01-01"),t=Object.assign({},n,t),{token:this.token,model:(null==(o=this.model)?void 0:o.export())||null}),o=F(e,JSON.stringify(n),t),i="undefined"!=typeof Blob?new Blob([o]).size:o.length;return n.model&&4096<i&&(n.model={id:null==(i=null==n?void 0:n.model)?void 0:i.id,email:null==(i=null==n?void 0:n.model)?void 0:i.email},this.model instanceof S&&(n.model.username=this.model.username,n.model.verified=this.model.verified,n.model.collectionId=this.model.collectionId),o=F(e,JSON.stringify(n),t)),o},A.prototype.onChange=function(e,t){var n=this;return void 0===t&&(t=!1),this._onChangeCallbacks.push(e),t&&e(this.token,this.model),function(){for(var t=n._onChangeCallbacks.length-1;0<=t;t--)if(n._onChangeCallbacks[t]==e)return delete n._onChangeCallbacks[t],void n._onChangeCallbacks.splice(t,1)}},A.prototype.triggerChange=function(){for(var t=0,e=this._onChangeCallbacks;t<e.length;t++){var n=e[t];n&&n(this.token,this.model)}},t(_,m=A),Object.defineProperty(_.prototype,"token",{get:function(){return(this._storageGet(this.storageKey)||{}).token||""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"model",{get:function(){var t,e=this._storageGet(this.storageKey)||{};return null===e||"object"!=typeof e||null===e.model||"object"!=typeof e.model?null:new(void 0===(null==(t=e.model)?void 0:t.collectionId)?H:S)(e.model)},enumerable:!1,configurable:!0}),_.prototype.save=function(t,e){this._storageSet(this.storageKey,{token:t,model:e}),m.prototype.save.call(this,t,e)},_.prototype.clear=function(){this._storageRemove(this.storageKey),m.prototype.clear.call(this)},_.prototype._storageGet=function(t){if("undefined"!=typeof window&&null!==window&&void 0!==window&&window.localStorage){var e=window.localStorage.getItem(t)||"";try{return JSON.parse(e)}catch(t){return e}}return this.storageFallback[t]},_.prototype._storageSet=function(t,e){var n;"undefined"!=typeof window&&null!==window&&void 0!==window&&window.localStorage?("string"!=typeof(n=e)&&(n=JSON.stringify(e)),window.localStorage.setItem(t,n)):this.storageFallback[t]=e},_.prototype._storageRemove=function(t){var e;"undefined"!=typeof window&&null!==window&&window.localStorage&&null!=(e=window.localStorage)&&e.removeItem(t),delete this.storageFallback[t]},_),V=(t(x,K=e),x.prototype.getAll=function(t){return this.client.send("/api/settings",{method:"GET",params:t=void 0===t?{}:t}).then(function(t){return t||{}})},x.prototype.update=function(t,e){return this.client.send("/api/settings",{method:"PATCH",params:e=void 0===e?{}:e,body:t=void 0===t?{}:t}).then(function(t){return t||{}})},x.prototype.testS3=function(t){return this.client.send("/api/settings/test/s3",{method:"POST",params:t=void 0===t?{}:t}).then(function(){return!0})},x.prototype.testEmail=function(t,e,n){return this.client.send("/api/settings/test/email",{method:"POST",params:n=void 0===n?{}:n,body:{email:t,template:e}}).then(function(){return!0})},x),O=(t(E,y=e),E.prototype._getFullList=function(e,o,i){function r(n){return l(t,void 0,void 0,function(){return c(this,function(t){return[2,this._getList(e,n,o,i).then(function(t){var e=t.items,t=t.totalItems;return s=s.concat(e),e.length&&t>s.length?r(n+1):s})]})})}var t=this,s=(void 0===o&&(o=100),void 0===i&&(i={}),[]);return r(1)},E.prototype._getList=function(t,e,n,o){var r=this;return void 0===e&&(e=1),void 0===n&&(n=30),void 0===o&&(o={}),o=Object.assign({page:e,perPage:n},o),this.client.send(t,{method:"GET",params:o}).then(function(t){var e=[];if(null!=t&&t.items){t.items=t.items||[];for(var n=0,o=t.items;n<o.length;n++){var i=o[n];e.push(r.decode(i))}}return new B((null==t?void 0:t.page)||1,(null==t?void 0:t.perPage)||0,(null==t?void 0:t.totalItems)||0,(null==t?void 0:t.totalPages)||0,e)})},E.prototype._getOne=function(t,e,n){var o=this;return void 0===n&&(n={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"GET",params:n}).then(function(t){return o.decode(t)})},E.prototype._getFirstListItem=function(t,e,n){return void 0===n&&(n={}),n=Object.assign({filter:e,$cancelKey:"one_by_filter_"+t+"_"+e},n),this._getList(t,1,1,n).then(function(t){var e;if(null!=(e=null==t?void 0:t.items)&&e.length)return t.items[0];throw new h({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}})})},E.prototype._create=function(t,e,n){var o=this;return this.client.send(t,{method:"POST",params:n=void 0===n?{}:n,body:e=void 0===e?{}:e}).then(function(t){return o.decode(t)})},E.prototype._update=function(t,e,n,o){var i=this;return void 0===n&&(n={}),void 0===o&&(o={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"PATCH",params:o,body:n}).then(function(t){return i.decode(t)})},E.prototype._delete=function(t,e,n){return void 0===n&&(n={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"DELETE",params:n}).then(function(){return!0})},E),O=(t(T,v=O),T.prototype.getFullList=function(t,e){return this._getFullList(this.baseCrudPath,t=void 0===t?200:t,e=void 0===e?{}:e)},T.prototype.getList=function(t,e,n){return this._getList(this.baseCrudPath,t=void 0===t?1:t,e=void 0===e?30:e,n=void 0===n?{}:n)},T.prototype.getFirstListItem=function(t,e){return this._getFirstListItem(this.baseCrudPath,t,e=void 0===e?{}:e)},T.prototype.getOne=function(t,e){return this._getOne(this.baseCrudPath,t,e=void 0===e?{}:e)},T.prototype.create=function(t,e){return this._create(this.baseCrudPath,t=void 0===t?{}:t,e=void 0===e?{}:e)},T.prototype.update=function(t,e,n){return this._update(this.baseCrudPath,t,e=void 0===e?{}:e,n=void 0===n?{}:n)},T.prototype.delete=function(t,e){return this._delete(this.baseCrudPath,t,e=void 0===e?{}:e)},T),Q=(t(R,f=O),R.prototype.decode=function(t){return new H(t)},Object.defineProperty(R.prototype,"baseCrudPath",{get:function(){return"/api/admins"},enumerable:!1,configurable:!0}),R.prototype.update=function(t,e,n){var o=this;return f.prototype.update.call(this,t,e=void 0===e?{}:e,n=void 0===n?{}:n).then(function(t){var e;return o.client.authStore.model&&void 0===(null==(e=o.client.authStore.model)?void 0:e.collectionId)&&(null==(e=o.client.authStore.model)?void 0:e.id)===(null==t?void 0:t.id)&&o.client.authStore.save(o.client.authStore.token,t),t})},R.prototype.delete=function(n,t){var o=this;return f.prototype.delete.call(this,n,t=void 0===t?{}:t).then(function(t){var e;return t&&o.client.authStore.model&&void 0===(null==(e=o.client.authStore.model)?void 0:e.collectionId)&&(null==(e=o.client.authStore.model)?void 0:e.id)===n&&o.client.authStore.clear(),t})},R.prototype.authResponse=function(t){var e=this.decode((null==t?void 0:t.admin)||{});return null!=t&&t.token&&null!=t&&t.admin&&this.client.authStore.save(t.token,e),Object.assign({},t,{token:(null==t?void 0:t.token)||"",admin:e})},R.prototype.authWithPassword=function(t,e,n,o){return void 0===n&&(n={}),void 0===o&&(o={}),n=Object.assign({identity:t,password:e},n),this.client.send(this.baseCrudPath+"/auth-with-password",{method:"POST",params:o,body:n,headers:{Authorization:""}}).then(this.authResponse.bind(this))},R.prototype.authRefresh=function(t,e){return this.client.send(this.baseCrudPath+"/auth-refresh",{method:"POST",params:e=void 0===e?{}:e,body:t=void 0===t?{}:t}).then(this.authResponse.bind(this))},R.prototype.requestPasswordReset=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),e=Object.assign({email:t},e),this.client.send(this.baseCrudPath+"/request-password-reset",{method:"POST",params:n,body:e}).then(function(){return!0})},R.prototype.confirmPasswordReset=function(t,e,n,o,i){return void 0===o&&(o={}),void 0===i&&(i={}),o=Object.assign({token:t,password:e,passwordConfirm:n},o),this.client.send(this.baseCrudPath+"/confirm-password-reset",{method:"POST",params:i,body:o}).then(this.authResponse.bind(this))},R),X=(t(at,p=w),at.prototype.load=function(t){p.prototype.load.call(this,t),this.recordId="string"==typeof t.recordId?t.recordId:"",this.collectionId="string"==typeof t.collectionId?t.collectionId:"",this.provider="string"==typeof t.provider?t.provider:"",this.providerId="string"==typeof t.providerId?t.providerId:""},at),Y=(t(k,d=O),k.prototype.decode=function(t){return new S(t)},Object.defineProperty(k.prototype,"baseCrudPath",{get:function(){return this.baseCollectionPath+"/records"},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"baseCollectionPath",{get:function(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)},enumerable:!1,configurable:!0}),k.prototype.subscribe=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,this.client.realtime.subscribe(this.collectionIdOrName,e)]})})},k.prototype.subscribeOne=function(e,n){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,n)]})})},k.prototype.unsubscribe=function(){for(var s=[],t=0;t<arguments.length;t++)s[t]=arguments[t];return l(this,void 0,void 0,function(){var e,n,o,i,r;return c(this,function(t){if(s&&s.length){for(e=[],n=0,o=s;n<o.length;n++)i=o[n],e.push(this.collectionIdOrName+"/"+i);return[2,(r=this.client.realtime).unsubscribe.apply(r,e)]}return[2,this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)]})})},k.prototype.update=function(t,e,n){var o=this;return d.prototype.update.call(this,t,e=void 0===e?{}:e,n=void 0===n?{}:n).then(function(t){var e;return void 0!==(null==(e=o.client.authStore.model)?void 0:e.collectionId)&&(null==(e=o.client.authStore.model)?void 0:e.id)===(null==t?void 0:t.id)&&o.client.authStore.save(o.client.authStore.token,t),t})},k.prototype.delete=function(n,t){var o=this;return d.prototype.delete.call(this,n,t=void 0===t?{}:t).then(function(t){var e;return t&&void 0!==(null==(e=o.client.authStore.model)?void 0:e.collectionId)&&(null==(e=o.client.authStore.model)?void 0:e.id)===n&&o.client.authStore.clear(),t})},k.prototype.authResponse=function(t){var e=this.decode((null==t?void 0:t.record)||{});return this.client.authStore.save(null==t?void 0:t.token,e),Object.assign({},t,{token:(null==t?void 0:t.token)||"",record:e})},k.prototype.listAuthMethods=function(t){return this.client.send(this.baseCollectionPath+"/auth-methods",{method:"GET",params:t=void 0===t?{}:t}).then(function(t){return Object.assign({},t,{usernamePassword:!(null==t||!t.usernamePassword),emailPassword:!(null==t||!t.emailPassword),authProviders:Array.isArray(null==t?void 0:t.authProviders)?null==t?void 0:t.authProviders:[]})})},k.prototype.authWithPassword=function(t,e,n,o){var i=this;return void 0===n&&(n={}),void 0===o&&(o={}),n=Object.assign({identity:t,password:e},n),this.client.send(this.baseCollectionPath+"/auth-with-password",{method:"POST",params:o,body:n,headers:{Authorization:""}}).then(function(t){return i.authResponse(t)})},k.prototype.authWithOAuth2=function(t,e,n,o,i,r,s){var a=this;return void 0===i&&(i={}),void 0===r&&(r={}),void 0===s&&(s={}),r=Object.assign({provider:t,code:e,codeVerifier:n,redirectUrl:o,createData:i},r),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",{method:"POST",params:s,body:r}).then(function(t){return a.authResponse(t)})},k.prototype.authRefresh=function(t,e){var n=this;return this.client.send(this.baseCollectionPath+"/auth-refresh",{method:"POST",params:e=void 0===e?{}:e,body:t=void 0===t?{}:t}).then(function(t){return n.authResponse(t)})},k.prototype.requestPasswordReset=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),e=Object.assign({email:t},e),this.client.send(this.baseCollectionPath+"/request-password-reset",{method:"POST",params:n,body:e}).then(function(){return!0})},k.prototype.confirmPasswordReset=function(t,e,n,o,i){var r=this;return void 0===o&&(o={}),void 0===i&&(i={}),o=Object.assign({token:t,password:e,passwordConfirm:n},o),this.client.send(this.baseCollectionPath+"/confirm-password-reset",{method:"POST",params:i,body:o}).then(function(t){return r.authResponse(t)})},k.prototype.requestVerification=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),e=Object.assign({email:t},e),this.client.send(this.baseCollectionPath+"/request-verification",{method:"POST",params:n,body:e}).then(function(){return!0})},k.prototype.confirmVerification=function(t,e,n){var o=this;return void 0===e&&(e={}),void 0===n&&(n={}),e=Object.assign({token:t},e),this.client.send(this.baseCollectionPath+"/confirm-verification",{method:"POST",params:n,body:e}).then(function(t){return o.authResponse(t)})},k.prototype.requestEmailChange=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),e=Object.assign({newEmail:t},e),this.client.send(this.baseCollectionPath+"/request-email-change",{method:"POST",params:n,body:e}).then(function(){return!0})},k.prototype.confirmEmailChange=function(t,e,n,o){var i=this;return void 0===n&&(n={}),void 0===o&&(o={}),n=Object.assign({token:t,password:e},n),this.client.send(this.baseCollectionPath+"/confirm-email-change",{method:"POST",params:o,body:n}).then(function(t){return i.authResponse(t)})},k.prototype.listExternalAuths=function(t,e){return void 0===e&&(e={}),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths",{method:"GET",params:e}).then(function(t){var e=[];if(Array.isArray(t))for(var n=0,o=t;n<o.length;n++){var i=o[n];e.push(new X(i))}return e})},k.prototype.unlinkExternalAuth=function(t,e,n){return void 0===n&&(n={}),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths/"+encodeURIComponent(e),{method:"DELETE",params:n}).then(function(){return!0})},k),Z=(st.prototype.load=function(t){this.id=void 0!==t.id?t.id:"",this.name=void 0!==t.name?t.name:"",this.type=void 0!==t.type?t.type:"text",this.system=!!t.system,this.required=!!t.required,this.unique=!!t.unique,this.options="object"==typeof t.options&&null!==t.options?t.options:{}},st),tt=(t(j,u=w),j.prototype.load=function(t){u.prototype.load.call(this,t),this.system=!!t.system,this.name="string"==typeof t.name?t.name:"",this.type="string"==typeof t.type?t.type:"base",this.options=void 0!==t.options?t.options:{},this.listRule="string"==typeof t.listRule?t.listRule:null,this.viewRule="string"==typeof t.viewRule?t.viewRule:null,this.createRule="string"==typeof t.createRule?t.createRule:null,this.updateRule="string"==typeof t.updateRule?t.updateRule:null,this.deleteRule="string"==typeof t.deleteRule?t.deleteRule:null,t.schema=Array.isArray(t.schema)?t.schema:[],this.schema=[];for(var e=0,n=t.schema;e<n.length;e++){var o=n[e];this.schema.push(new Z(o))}},Object.defineProperty(j.prototype,"isBase",{get:function(){return"base"===this.type},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isAuth",{get:function(){return"auth"===this.type},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isSingle",{get:function(){return"single"===this.type},enumerable:!1,configurable:!0}),j),et=(t(I,a=O),I.prototype.decode=function(t){return new tt(t)},Object.defineProperty(I.prototype,"baseCrudPath",{get:function(){return"/api/collections"},enumerable:!1,configurable:!0}),I.prototype.import=function(e,n,o){return void 0===n&&(n=!1),void 0===o&&(o={}),l(this,void 0,void 0,function(){return c(this,function(t){return[2,this.client.send(this.baseCrudPath+"/import",{method:"PUT",params:o,body:{collections:e,deleteMissing:n}}).then(function(){return!0})]})})},I),nt=(t(rt,s=w),rt.prototype.load=function(t){s.prototype.load.call(this,t),t.remoteIp=t.remoteIp||t.ip,this.url="string"==typeof t.url?t.url:"",this.method="string"==typeof t.method?t.method:"GET",this.status="number"==typeof t.status?t.status:200,this.auth="string"==typeof t.auth?t.auth:"guest",this.remoteIp="string"==typeof t.remoteIp?t.remoteIp:"",this.userIp="string"==typeof t.userIp?t.userIp:"",this.referer="string"==typeof t.referer?t.referer:"",this.userAgent="string"==typeof t.userAgent?t.userAgent:"",this.meta="object"==typeof t.meta&&null!==t.meta?t.meta:{}},rt),ot=(t(P,i=e),P.prototype.getRequestsList=function(t,e,n){return void 0===t&&(t=1),void 0===e&&(e=30),void 0===n&&(n={}),n=Object.assign({page:t,perPage:e},n),this.client.send("/api/logs/requests",{method:"GET",params:n}).then(function(t){var e=[];if(null!=t&&t.items){t.items=(null==t?void 0:t.items)||[];for(var n=0,o=t.items;n<o.length;n++){var i=o[n];e.push(new nt(i))}}return new B((null==t?void 0:t.page)||1,(null==t?void 0:t.perPage)||0,(null==t?void 0:t.totalItems)||0,(null==t?void 0:t.totalPages)||0,e)})},P.prototype.getRequest=function(t,e){return void 0===e&&(e={}),this.client.send("/api/logs/requests/"+encodeURIComponent(t),{method:"GET",params:e}).then(function(t){return new nt(t)})},P.prototype.getRequestsStats=function(t){return this.client.send("/api/logs/requests/stats",{method:"GET",params:t=void 0===t?{}:t}).then(function(t){return t})},P),it=(t(C,o=e),C.prototype.subscribe=function(e,o){var n;return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:if(e)return!this.subscriptions[e]||null!=(n=this.eventSource)&&n.removeEventListener(e,this.subscriptions[e]),this.subscriptions[e]=function(t){var e,n=t;try{e=JSON.parse(null==n?void 0:n.data)}catch(t){}o(e||{})},this.eventSource?[3,1]:(this.connect(),[3,3]);throw new Error("subscription must be set.");case 1:return this.clientId?[4,this.submitSubscriptions()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},C.prototype.unsubscribeByPrefix=function(o){return l(this,void 0,void 0,function(){var e,n;return c(this,function(t){for(n in e=[],this.subscriptions)n.startsWith(o)&&e.push(n);return e.length?[2,this.unsubscribe.apply(this,e)]:[2]})})},C.prototype.unsubscribe=function(){for(var r,s=[],t=0;t<arguments.length;t++)s[t]=arguments[t];return l(this,void 0,void 0,function(){var e,n,o,i;return c(this,function(t){switch(t.label){case 0:if(s&&0!=s.length){for(e=!1,n=0,o=s;n<o.length;n++)i=o[n],e=!0,null!=(r=this.eventSource)&&r.removeEventListener(i,this.subscriptions[i]),delete this.subscriptions[i];if(!e)return[2]}else this.removeSubscriptionListeners(),this.subscriptions={};return this.clientId?[4,this.submitSubscriptions()]:[3,2];case 1:t.sent(),t.label=2;case 2:return Object.keys(this.subscriptions).length||this.disconnect(),[2]}})})},C.prototype.submitSubscriptions=function(){return l(this,void 0,void 0,function(){return c(this,function(t){return this.addSubscriptionListeners(),[2,this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:Object.keys(this.subscriptions)},params:{$autoCancel:!1}}).then(function(){return!0})]})})},C.prototype.addSubscriptionListeners=function(){if(this.eventSource)for(var t in this.removeSubscriptionListeners(),this.subscriptions)this.eventSource.addEventListener(t,this.subscriptions[t])},C.prototype.removeSubscriptionListeners=function(){if(this.eventSource)for(var t in this.subscriptions)this.eventSource.removeEventListener(t,this.subscriptions[t])},C.prototype.connectHandler=function(t){this.clientId=null==t?void 0:t.lastEventId,this.submitSubscriptions()},C.prototype.connect=function(){var e=this;this.disconnect(),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.addEventListener("PB_CONNECT",function(t){return e.connectHandler(t)})},C.prototype.disconnect=function(){var t,e=this;this.removeSubscriptionListeners(),null!=(t=this.eventSource)&&t.removeEventListener("PB_CONNECT",function(t){return e.connectHandler(t)}),null!=(t=this.eventSource)&&t.close(),this.eventSource=null,this.clientId=""},C);function C(){var t=null!==o&&o.apply(this,arguments)||this;return t.clientId="",t.eventSource=null,t.subscriptions={},t}function P(){return null!==i&&i.apply(this,arguments)||this}function rt(){return null!==s&&s.apply(this,arguments)||this}function I(){return null!==a&&a.apply(this,arguments)||this}function j(){return null!==u&&u.apply(this,arguments)||this}function st(t){this.load((t=void 0===t?{}:t)||{})}function k(t,e){t=d.call(this,t)||this;return t.collectionIdOrName=e,t}function at(){return null!==p&&p.apply(this,arguments)||this}function R(){return null!==f&&f.apply(this,arguments)||this}function T(){return null!==v&&v.apply(this,arguments)||this}function E(){return null!==y&&y.apply(this,arguments)||this}function x(){return null!==K&&K.apply(this,arguments)||this}function _(t){void 0===t&&(t="pocketbase_auth");var e=m.call(this)||this;return e.storageFallback={},e.storageKey=t,e}function A(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}function ut(){return null!==b&&b.apply(this,arguments)||this}function lt(){return null!==g&&g.apply(this,arguments)||this}function L(t){this.load((t=void 0===t?{}:t)||{})}return N.prototype.collection=function(t){return this.recordServices[t]||(this.recordServices[t]=new Y(this,t)),this.recordServices[t]},N.prototype.autoCancellation=function(t){return this.enableAutoCancellation=!!t,this},N.prototype.cancelRequest=function(t){return this.cancelControllers[t]&&(this.cancelControllers[t].abort(),delete this.cancelControllers[t]),this},N.prototype.cancelAllRequests=function(){for(var t in this.cancelControllers)this.cancelControllers[t].abort();return this.cancelControllers={},this},N.prototype.send=function(r,s){var a,u;return l(this,void 0,void 0,function(){var e,n,o,i=this;return c(this,function(t){return(e=Object.assign({method:"GET"},s)).body&&"FormData"!==e.body.constructor.name&&("string"!=typeof e.body&&(e.body=JSON.stringify(e.body)),void 0===(null==(a=null==e?void 0:e.headers)?void 0:a["Content-Type"])&&(e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}))),void 0===(null==(a=null==e?void 0:e.headers)?void 0:a["Accept-Language"])&&(e.headers=Object.assign({},e.headers,{"Accept-Language":this.lang})),null!=(u=this.authStore)&&u.token&&void 0===(null==(u=null==e?void 0:e.headers)?void 0:u.Authorization)&&(e.headers=Object.assign({},e.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&!1!==(null==(u=e.params)?void 0:u.$autoCancel)&&(n=(null==(u=e.params)?void 0:u.$cancelKey)||(e.method||"GET")+r,this.cancelRequest(n),o=new AbortController,this.cancelControllers[n]=o,e.signal=o.signal),null!=(u=e.params)&&delete u.$autoCancel,null!=(u=e.params)&&delete u.$cancelKey,n=this.buildUrl(r),void 0!==e.params&&((o=this.serializeQueryParams(e.params))&&(n+=(n.includes("?")?"&":"?")+o),delete e.params),this.beforeSend&&(e=Object.assign({},this.beforeSend(n,e))),[2,fetch(n,e).then(function(n){return l(i,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:e={},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.json()];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:if(this.afterSend&&(e=this.afterSend(n,e)),400<=n.status)throw new h({url:n.url,status:n.status,data:e});return[2,e]}})})}).catch(function(t){throw new h(t)})]})})},N.prototype.getFileUrl=function(t,e,n){void 0===n&&(n={});var o=[],t=(o.push("api"),o.push("files"),o.push(encodeURIComponent(t.collectionId||t.collectionName)),o.push(encodeURIComponent(t.id)),o.push(encodeURIComponent(e)),this.buildUrl(o.join("/")));return Object.keys(n).length&&(e=new URLSearchParams(n),t+=(t.includes("?")?"&":"?")+e),t},N.prototype.buildUrl=function(t){var e=this.baseUrl+(this.baseUrl.endsWith("/")?"":"/");return t&&(e+=t.startsWith("/")?t.substring(1):t),e},N.prototype.serializeQueryParams=function(t){var e,n=[];for(e in t)if(null!==t[e]){var o=t[e],i=encodeURIComponent(e);if(Array.isArray(o))for(var r=0,s=o;r<s.length;r++){var a=s[r];n.push(i+"="+encodeURIComponent(a))}else o instanceof Date?n.push(i+"="+encodeURIComponent(o.toISOString())):null!==typeof o&&"object"==typeof o?n.push(i+"="+encodeURIComponent(JSON.stringify(o))):n.push(i+"="+encodeURIComponent(o))}return n.join("&")},N;function N(t,e,n){void 0===t&&(t="/"),void 0===n&&(n="en-US"),this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=t,this.lang=n,this.authStore=e||new W,this.admins=new Q(this),this.collections=new et(this),this.logs=new ot(this),this.settings=new V(this),this.realtime=new it(this)}});